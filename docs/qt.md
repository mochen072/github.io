# 其他一些漏洞
## <font color = #1E90FF>权限绕过</font>
### <font color = #FF0000>水平越权</font>
#### <font color = #FFA500>案例1:</font>
__通过水平越权漏洞实现修改或删除其他用户个人信息__

#### <font color = #FFA500>测试方法:</font>
- **申请两个帐户,如test3和test4**
- **抓取test4用户的请求数据包,通过修改数据包中代表用户ID相关参数的值,判断是否通过修改test4用户的数据来实现修改或删除test3用户的信息。**

#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

### <font color = #FF0000>垂直越权</font>
#### <font color = #FFA500>案例1:</font>
__通过垂直越权漏洞实现在没有任何权限的情况下添加管理员用户，获得管理员权限__

#### <font color = #FFA500>测试方法:</font>
- **在添加用户处抓取请求数据包，生成form表单，设置账户密码，越权添加管理用户**


#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

## <font color = #1E90FF>支付逻辑漏洞</font>
### <font color = #FF0000>原理</font>
__支付逻辑漏洞是指系统的支付流程中存在业务逻辑层面的漏洞。支付流程通常为选择商品和数量选择支付及配送方式-生成订单订单支付完成支付最常见的支付逻辑漏洞通常是由于服务器端没有对客户端请求数据中的金额、数量等敏感信息作校验导致一般在电子商务网站上容易出现此类漏洞__

- **支付逻辑漏洞一般可以分为四类**
    - **1.支付过程中可以修改支付金额**
    - **2.可以将订单中的商品数量修改为负值**
    - **3.请求重放**
    - **4.其他问题(程序异常，其他参数修改导致的问题等)**

### <font color = #FF0000>支付逻辑漏洞的危害</font>
__任意金额购买商品，甚至可以导致购买商品后系统给自己账号充值__

### <font color = #FF0000>测试方法</font>
#### <font color = #FFA500>支付逻辑漏洞之修改订单商品数量:</font>
- **1、登录网站,选择购买-一个商品并抓取数据包**
- **2、找到其中代表商品数量的参数,将参数的值修改为负数**
- **3、发送数据包，生成订单,观察订单是否有效,是否能进入支付页面**
- **4、完成支付**

#### <font color = #FFA500>案例1:</font>
__通过支付逻辑漏洞修改订单商品数量实现0元购__
#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

## <font color = #1E90FF>密码找回漏洞</font>
### <font color = #FF0000>用户凭证客户端回显</font>
__找回密码功能模块通常会将用户凭证(通常为验证码或者链接)发送到用户注册时使用的手机号或者邮箱中,只要用户不泄露自己的用户凭证就不会被攻击者利用。有些信息系统在密码找回功能的设计存在逻辑缺陷,可能会将用于用户自证身份的信息的用户凭证以各种各样的方式返回到客户端。这样攻击者只要通过在本地抓取数据包并对其内容加以分析就能获取到其他用户的用户凭证,从而达到重置任意用户密码的目的。__

#### <font color = #FFA500>测试方法:</font>
__在测试系统是否存在用户凭证客户端回显漏洞时,可以先用自己的账号进行密码找回操作,并在抓取记录每次交互操作时的response数据包。然后观察分析数据包中是否存在和手机或邮箱中收到的用户凭证相同的字符串。__

### <font color = #FF0000>案例1:</font>
#### <font color = #FFA500>用户凭证暴露在请求链接中</font>
- **1.进入某直播网站登录处，点击忘记密码，选择通过注册手机找回密码**
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt1.png">
</figure>

- **2.输入手机号码，点击获取验证码，然后使用firebug查看请求链接，将发现验证码直接出现在请求链接中**

### <font color = #FF0000>案例2:</font>
#### <font color = #FFA500>加密验证字符串返回给客户端</font>
- **1.进入某电商官网按正常流程执行找回密码功能,填写好邮箱和图片验证码,点击下一步,然后使用抓包工具抓取请求包。分析返回的数据包,发现其中包含了一个加密字符串,将其记录下来。**
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt2.png">
</figure>

- **2.之后，邮箱中会收到一个找回密码用的验证码，将该验证码在页面上填好，点击下一步即可进入到重置页面**

### <font color = #FF0000>案例3:</font>
#### <font color = #FFA500>网页源代码中隐藏着密保答案</font>
- **1.进入某邮箱网站官网，点击找回密码按钮，再点击网上申诉链接**
- **2. 按f12 会发现密保答案显示在源代码里，通过该方式，可以修改其他用户密码**

### <font color = #FF0000>案例4:</font>
#### <font color = #FFA500>短信验证码在客户端回显</font>
- **1.进入商城网站首页，点击忘记密码，然后通过短信的方式找回密码**
- **2.输入图片验证码，点击获取短信验证码**
- **3.此时抓取数据包,发现服务端直接将短信验证码xxx返回给了客户端,将短信验证码填写到验证码处即可成功重置其密码。同理,通过该方式,可以重置其他用户的密码。**

## <font color = #1E90FF>验证码暴力破解测试</font>
__通常是在网站的用户注册，密码找回等页面会设计有收集或邮箱验证码验证，主要是为了贯彻落实上网实名制，一级保障用户账号的安全性<BR>当这些验证码具有一定的规律性，并且没有做好对应的防护措施时，会导致攻击者通过穷举或者其他方式猜解出验证码，从而对目标系统造成危害__

### <font color = #FF0000>短信验证码流程:</font>
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt3.png">
</figure>

### <font color = #FF0000>案例1:</font>
#### <font color = #FFA500>通过暴力破解短信验证码实现重置任意用户密码</font>
#### <font color = #FFA500>测试方法:</font>
- **1、接收验证码,观察验证码是否有规律性(如纯数字或可预测的字母)**
- **2、多次填写验证码提交,观察是否有时效性或失败次数限制。**
- **3、通过工具暴力猜解验证码**
#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

## <font color = #1E90FF>验证码重复使用</font>
__如果设计不合理，将会导致验证码在验证成功一次之后，下次使用的时候就不再刷新，也就是可重复使用__
### <font color = #FF0000>验证码校验流程</font>
__当服务器端受理请求后，没有将上一次保存的session及时清空，将会导致验证码可重复使用__
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt4.png">
</figure>

### <font color = #FF0000>案例1:</font>
__通过重复使用验证码实现登录页面暴力破解。__
#### <font color = #FFA500>测试方法:</font>
__通过重放请求,观察返回的信息提示来进行判断。如果通过重放没有提示"验证码错误”之类的信息,而只是提示“用户名密码错误”这些信息,就说明存在漏洞__
#### <font color = #FFA500>测试工具:</font>
## <font color = #1E90FF>验证码客户端回显</font>
__由于开发人员的代码逻辑问题，在调用短信平台发送短信时，没有判断验证码和手机号是否绑定，并且把验证码校验功能放到客户端来进行，从而导致验证码在客户端回显，回显一般分两种情况:__
- **1.验证码输出在客户端页面中**
- **验证码输出在返回数据包中**
### <font color = #FF0000>案例1:</font>
__通过验证码客户端回显漏洞实现帐户绑定任意手机号码__
#### <font color = #FFA500>测试方法:</font>
- **1、输入任意手机号码,点击发送短信验证码并抓取数据包**
- **2、查看返回数据包,观察验证码是否回显。**
- **3、若回显,则提交验证码。**
#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

## <font color = #1E90FF>验证码绕过</font>
__由于开发人员使用了错误的逻辑判断，仅仅在客户端接收用户输入的验证码，并且在本地校验验证码是否正确，而该判断结果也可以在本地进行修改，最终导致用户端误以为我们已经输入了正确的验证码，实现验证码绕过__

</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt5.png">
</figure>

### <font color = #FF0000>案例1:</font>
__通过验证码绕过漏洞实现重置任意用户密码__
#### <font color = #FFA500>测试方法:</font>
- **1、在接收验证码后,输入任意验证码,提交并抓包**
- **2、尝试修改返回包中相关的参数值。**
- **3、转发数据包,若进入密码重置页面,则证明存在漏洞。**
#### <font color = #FFA500>测试工具:</font>
- **burpsuite**

## <font color = #1E90FF>验证码自动识别</font>
__当验证码设计不存在逻辑层面的问题时,就要涉及到与验证码机制本身的正面对抗,也就是验证码识别技术。<BR>这里的验证码主要是指图片验证码。<BR>验证码自动识别就是指通过自动化的技术对图片验证码中的字符或公式等内容进行还原,从而突破验证码的安全限制。__
### <font color = #FF0000>图片验证码识别流程</font>
- **图像二值化-->去干扰-->字符分割-->字符识别**

- __图像二值化就是将图像上像素点的灰度值设置为0或255 ,也就是将整个图像呈现出明显的黑白效果。为了防止验证码被自动识别,通常会加入- -些点、线、色彩之类的方式进行图像干扰,如下所示:__
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt6.png">
</figure>

__所以为了达到良好的识别效果,需要对图像进行去干扰处理。__

- **字符分割主要包括从验证码图像中分割出字符区域以及把字符区域划分成单个字符。字符识别就是把处理后的图片还原回字符文本的过程**

### <font color = #FF0000>验证码自动识别流程</font>
</figure>
     <figure class="thumbnails">
        <img src="picture/qt/qt7.png">
</figure>

### <font color = #FF0000>案例1:</font>
__通过验证码自动识别漏洞实现暴力破解登录密码。__
#### <font color = #FFA500>测试方法:</font>
- **1、获取验证码链接**
- **2、将链接载入验证码识别工具进行验证码识别,配置相关工具**
- **3、如成功破解用户帐户,则证明验证码识别有效。**
#### <font color = #FFA500>测试工具:</font>
- **burpsuite. Pkav http fuzzer**

